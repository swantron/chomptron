<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#000000" />

    <!-- Primary Meta Tags -->
    <title>Chomptron - AI-Powered Recipe Generator</title>
    <meta name="title" content="Chomptron - AI-Powered Recipe Generator" />
    <meta
      name="description"
      content="Turn your ingredients into delicious recipes with AI. Chomptron uses Google Gemini AI to create personalized recipes from whatever you have in your kitchen. Built by Joseph Swanson."
    />
    <meta
      name="keywords"
      content="AI recipe generator, recipe app, cooking assistant, ingredient-based recipes, Gemini AI, Google Cloud, Joseph Swanson, chomptron, AI cooking, recipe maker, meal planner"
    />
    <meta name="author" content="Joseph Swanson" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta http-equiv="Content-Language" content="en-US" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://chomptron.com" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://chomptron.com" />
    <meta
      property="og:title"
      content="Chomptron - AI-Powered Recipe Generator"
    />
    <meta
      property="og:description"
      content="Turn your ingredients into delicious recipes with AI. Chomptron uses Google Gemini AI to create personalized recipes from whatever you have in your kitchen."
    />
    <meta
      property="og:image"
      content="https://chomptron.com/chomptron_512x512.png"
    />
    <meta property="og:site_name" content="Chomptron" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://chomptron.com" />
    <meta
      property="twitter:title"
      content="Chomptron - AI-Powered Recipe Generator"
    />
    <meta
      property="twitter:description"
      content="Turn your ingredients into delicious recipes with AI. Chomptron uses Google Gemini AI to create personalized recipes from whatever you have in your kitchen."
    />
    <meta
      property="twitter:image"
      content="https://chomptron.com/chomptron_512x512.png"
    />

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="//chomptron.com" />

    <!-- PWA Support -->
    <link rel="apple-touch-icon" href="/chomptron_192x192.png" />
    <link rel="manifest" href="/manifest.json" />

    <!-- Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Chomptron",
        "url": "https://chomptron.com",
        "description": "AI-Powered Recipe Generator using Google Gemini AI",
        "applicationCategory": "LifestyleApplication",
        "operatingSystem": "Any",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "author": {
          "@type": "Person",
          "name": "Joseph Swanson"
        },
        "creator": {
          "@type": "Person",
          "name": "Joseph Swanson"
        }
      }
    </script>
    <style>
      :root {
        --primary-bg: #0a0a0a;
        --secondary-bg: #f0f0f0;
        --primary-text: #ffffff;
        --secondary-text: #333333;
        --accent-color: #ff6b1a;
        --error-color: #ff4444;
        --success-color: #4caf50;
        --border-radius: 10px;
        --transition-speed: 0.3s;
        --max-width: 1200px;
        --container-padding: 20px;
        --border-color: #dfe6e9;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--primary-bg);
        min-height: 100vh;
        padding: var(--container-padding);
        color: var(--secondary-text);
      }

      .container {
        max-width: var(--max-width);
        margin: 0 auto;
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        padding: 40px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 1;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
        position: relative;
      }

      .header-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
        max-width: 100%;
      }

      .title-background {
        color: var(--accent-color);
        padding: 30px 40px;
        font-size: 4em;
        font-weight: bold;
        letter-spacing: 0.1em;
        text-transform: lowercase;
        margin-bottom: 20px;
        position: relative;
        z-index: 10;
      }

      .logo {
        position: fixed;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        max-width: 100%;
        width: 100%;
        height: auto;
        z-index: -1;
        pointer-events: none;
        opacity: 0.15;
      }

      h1 {
        font-size: 4em;
        color: var(--accent-color);
        margin-bottom: 20px;
        margin-top: 0;
        display: none;
      }

      .tagline {
        font-size: 1.2em;
        color: var(--secondary-text);
        opacity: 0.8;
      }

      .input-section h2 {
        color: var(--secondary-text);
        margin-bottom: 15px;
        font-size: 1.5em;
      }

      textarea {
        width: 100%;
        padding: 15px;
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: 1em;
        font-family: inherit;
        resize: vertical;
        transition: border-color var(--transition-speed);
        background: white;
      }

      textarea:focus {
        outline: none;
        border-color: var(--accent-color);
      }

      button {
        width: 100%;
        padding: 15px 30px;
        background: var(--accent-color);
        color: var(--primary-text);
        border: none;
        border-radius: var(--border-radius);
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        transition:
          transform var(--transition-speed),
          box-shadow var(--transition-speed);
        margin-top: 15px;
      }

      button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(248, 152, 89, 0.4);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .loading {
        text-align: center;
        padding: 40px;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid var(--border-color);
        border-top: 5px solid var(--accent-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .recipe-output {
        background: white;
        padding: 30px;
        border-radius: var(--border-radius);
        margin-top: 30px;
        border: 2px solid var(--border-color);
      }

      .recipe-output h2 {
        color: var(--accent-color);
        margin-bottom: 20px;
        font-size: 2em;
      }

      #recipeContent {
        line-height: 1.8;
        color: var(--secondary-text);
      }

      #recipeContent p {
        margin-bottom: 15px;
      }

      #recipeContent strong {
        color: var(--accent-color);
        font-size: 1.1em;
      }

      .error {
        background: #ffebee;
        color: var(--error-color);
        padding: 15px;
        border-radius: var(--border-radius);
        margin-top: 20px;
        border-left: 4px solid var(--error-color);
      }

      .hidden {
        display: none;
      }

      footer {
        text-align: center;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 2px solid var(--border-color);
        color: var(--secondary-text);
        opacity: 0.7;
      }

      footer a {
        color: #000000;
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }

      /* History Panel Styles */
      .history-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--accent-color);
        color: white;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        font-size: 1.5em;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: transform var(--transition-speed);
        z-index: 1000;
        margin: 0;
        padding: 0;
      }

      .history-toggle:hover {
        transform: scale(1.1);
      }

      .history-panel {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: white;
        box-shadow: -4px 0 12px rgba(0, 0, 0, 0.2);
        transition: right 0.3s ease;
        z-index: 999;
        overflow-y: auto;
        padding: 20px;
      }

      .history-panel.open {
        right: 0;
      }

      .history-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid var(--border-color);
      }

      .history-header h3 {
        color: var(--accent-color);
        margin: 0;
      }

      .close-history {
        background: none;
        border: none;
        font-size: 1.5em;
        cursor: pointer;
        color: var(--secondary-text);
        width: auto;
        padding: 5px 10px;
        margin: 0;
      }

      .close-history:hover {
        transform: none;
        box-shadow: none;
      }

      .history-controls {
        margin-bottom: 20px;
      }

      .history-search {
        width: 100%;
        padding: 10px;
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius);
        margin-bottom: 10px;
      }

      .history-buttons {
        display: flex;
        gap: 10px;
      }

      .history-buttons button {
        flex: 1;
        padding: 8px 12px;
        font-size: 0.9em;
        margin: 0;
      }

      .recipe-item {
        background: var(--secondary-bg);
        padding: 15px;
        margin-bottom: 10px;
        border-radius: var(--border-radius);
        cursor: pointer;
        border: 2px solid var(--border-color);
        transition: all var(--transition-speed);
      }

      .recipe-item:hover {
        border-color: var(--accent-color);
        transform: translateX(-5px);
      }

      .recipe-item-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 5px;
      }

      .recipe-name {
        font-weight: bold;
        color: var(--secondary-text);
        font-size: 1em;
        margin: 0;
      }

      .favorite-btn {
        background: none;
        border: none;
        font-size: 1.3em;
        cursor: pointer;
        padding: 0;
        width: auto;
        margin: 0;
        transition: transform var(--transition-speed);
      }

      .favorite-btn:hover {
        transform: scale(1.2);
        box-shadow: none;
      }

      .recipe-timestamp {
        font-size: 0.8em;
        color: #777;
      }

      .recipe-ingredients-preview {
        font-size: 0.85em;
        color: #666;
        margin-top: 5px;
        font-style: italic;
      }

      .empty-history {
        text-align: center;
        padding: 40px 20px;
        color: #999;
      }

      .recipe-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .recipe-header h2 {
        margin: 0;
      }

      .favorite-toggle-btn {
        margin: 0;
        padding: 10px 20px;
        font-size: 1em;
        background: white;
        color: var(--secondary-text);
        border: 2px solid var(--border-color);
        width: auto;
      }

      .favorite-toggle-btn.favorited {
        background: var(--accent-color);
        color: white;
        border-color: var(--accent-color);
      }

      @media (max-width: 768px) {
        .history-panel {
          width: 100%;
          right: -100%;
        }

        .history-toggle {
          width: 50px;
          height: 50px;
          font-size: 1.2em;
        }

        .recipe-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }

        .favorite-toggle-btn {
          width: 100%;
        }
      }

      @media (max-width: 600px) {
        .container {
          padding: 20px;
        }

        .header-wrapper {
          max-width: 100%;
        }

        .title-background {
          font-size: 2.5em;
          padding: 20px 20px;
        }

        .logo {
          max-width: 100%;
          opacity: 0.1;
        }

        h1 {
          font-size: 2.8em;
        }

        .tagline {
          font-size: 1em;
        }
      }
    </style>
  </head>
  <body>
    <!-- History Toggle Button -->
    <button class="history-toggle" onclick="toggleHistory()" title="Recipe History">
      üç≥
    </button>

    <!-- History Panel -->
    <div id="historyPanel" class="history-panel">
      <div class="history-header">
        <h3>Recipe History</h3>
        <button class="close-history" onclick="toggleHistory()">‚úï</button>
      </div>
      <div class="history-controls">
        <input
          type="text"
          id="historySearch"
          class="history-search"
          placeholder="Search recipes..."
          oninput="filterHistory()"
        />
        <div class="history-buttons">
          <button onclick="showFavorites()">‚≠ê Favorites</button>
          <button onclick="showAllHistory()">üìã All</button>
        </div>
        <div class="history-buttons" style="margin-top: 10px;">
          <button onclick="exportRecipes()">üíæ Export</button>
          <button onclick="clearHistory()">üóëÔ∏è Clear</button>
        </div>
      </div>
      <div id="historyList"></div>
    </div>

    <div class="container">
      <header>
        <div class="header-wrapper">
          <div class="title-background">chomp tron dot com</div>
          <img src="/chomptron.png" alt="Chomptron Logo" class="logo" />
        </div>
        <p class="tagline">Turn Your Ingredients Into Delicious Recipes</p>
      </header>

      <main>
        <div class="input-section">
          <h2>What's in Your Kitchen?</h2>
          <textarea
            id="ingredients"
            placeholder="Enter your ingredients (e.g., chicken, tomatoes, garlic, pasta, olive oil)"
            rows="5"
          ></textarea>
          <button id="generateBtn" onclick="generateRecipe()">
            Generate Recipe ‚ú®
          </button>
        </div>

        <div id="loadingIndicator" class="loading hidden">
          <div class="spinner"></div>
          <p>Cooking up something delicious...</p>
        </div>

        <div id="recipeOutput" class="recipe-output hidden">
          <div class="recipe-header">
            <h2>Your Recipe</h2>
            <button
              id="favoriteBtn"
              class="favorite-toggle-btn"
              onclick="toggleFavorite()"
              title="Add to favorites"
            >
              ‚òÜ Favorite
            </button>
          </div>
          <div id="recipeContent"></div>
          <button onclick="copyRecipe(event)">Copy Recipe üìã</button>
          <button onclick="clearRecipe()">Generate Another Recipe</button>
        </div>

        <div id="errorMessage" class="error hidden"></div>
      </main>

      <footer>
        <p>
          Powered by Google Gemini AI | Chomptron.com |
          <a
            href="https://tronswan.com"
            target="_blank"
            rel="noopener noreferrer"
            >tronswan.com</a
          >
        </p>
      </footer>
    </div>

    <script>
      // Recipe History & Favorites Manager
      const RecipeManager = {
        storageKey: "chomptron_recipes",
        currentRecipeId: null,

        getRecipes() {
          const stored = localStorage.getItem(this.storageKey);
          return stored ? JSON.parse(stored) : [];
        },

        saveRecipe(ingredients, recipe) {
          const recipes = this.getRecipes();
          const id = Date.now().toString();
          const recipeName = this.extractRecipeName(recipe);

          const newRecipe = {
            id,
            ingredients,
            recipe,
            recipeName,
            timestamp: new Date().toISOString(),
            favorite: false,
          };

          recipes.unshift(newRecipe);

          // Keep only last 100 recipes
          if (recipes.length > 100) {
            recipes.pop();
          }

          localStorage.setItem(this.storageKey, JSON.stringify(recipes));
          this.currentRecipeId = id;
          return id;
        },

        extractRecipeName(recipe) {
          // Try to extract recipe name from first line or heading
          const lines = recipe.split("\n");
          for (let line of lines) {
            const cleaned = line
              .replace(/\*\*/g, "")
              .replace(/^#+\s*/, "")
              .trim();
            if (cleaned && cleaned.length > 3 && cleaned.length < 100) {
              return cleaned;
            }
          }
          return "Untitled Recipe";
        },

        toggleFavorite(id) {
          const recipes = this.getRecipes();
          const recipe = recipes.find((r) => r.id === id);
          if (recipe) {
            recipe.favorite = !recipe.favorite;
            localStorage.setItem(this.storageKey, JSON.stringify(recipes));
          }
          return recipe?.favorite;
        },

        deleteRecipe(id) {
          let recipes = this.getRecipes();
          recipes = recipes.filter((r) => r.id !== id);
          localStorage.setItem(this.storageKey, JSON.stringify(recipes));
        },

        clearAll() {
          if (
            confirm(
              "Are you sure you want to clear all recipe history? This cannot be undone.",
            )
          ) {
            localStorage.removeItem(this.storageKey);
            this.currentRecipeId = null;
            renderHistory();
          }
        },

        exportToJSON() {
          const recipes = this.getRecipes();
          const dataStr = JSON.stringify(recipes, null, 2);
          const dataBlob = new Blob([dataStr], { type: "application/json" });
          const url = URL.createObjectURL(dataBlob);
          const link = document.createElement("a");
          link.href = url;
          link.download = `chomptron-recipes-${Date.now()}.json`;
          link.click();
          URL.revokeObjectURL(url);
        },

        exportToText() {
          const recipes = this.getRecipes();
          let text = "CHOMPTRON RECIPE COLLECTION\n";
          text += "=".repeat(50) + "\n\n";

          recipes.forEach((r, index) => {
            text += `Recipe #${index + 1}: ${r.recipeName}\n`;
            text += `Date: ${new Date(r.timestamp).toLocaleString()}\n`;
            text += `Ingredients: ${r.ingredients}\n`;
            text += `Favorite: ${r.favorite ? "‚≠ê Yes" : "No"}\n`;
            text += "-".repeat(50) + "\n";
            text += r.recipe + "\n";
            text += "=".repeat(50) + "\n\n";
          });

          const dataBlob = new Blob([text], { type: "text/plain" });
          const url = URL.createObjectURL(dataBlob);
          const link = document.createElement("a");
          link.href = url;
          link.download = `chomptron-recipes-${Date.now()}.txt`;
          link.click();
          URL.revokeObjectURL(url);
        },
      };

      let historyFilter = "all"; // 'all' or 'favorites'

      function toggleHistory() {
        const panel = document.getElementById("historyPanel");
        panel.classList.toggle("open");
        if (panel.classList.contains("open")) {
          renderHistory();
        }
      }

      function renderHistory(searchQuery = "") {
        const recipes = RecipeManager.getRecipes();
        const historyList = document.getElementById("historyList");

        let filtered = recipes;

        // Apply favorites filter
        if (historyFilter === "favorites") {
          filtered = recipes.filter((r) => r.favorite);
        }

        // Apply search filter
        if (searchQuery) {
          const query = searchQuery.toLowerCase();
          filtered = filtered.filter(
            (r) =>
              r.recipeName.toLowerCase().includes(query) ||
              r.ingredients.toLowerCase().includes(query) ||
              r.recipe.toLowerCase().includes(query),
          );
        }

        if (filtered.length === 0) {
          historyList.innerHTML = `
            <div class="empty-history">
              <p>${historyFilter === "favorites" ? "No favorite recipes yet" : searchQuery ? "No recipes found" : "No recipes yet"}</p>
              <p style="font-size: 0.9em;">Generate recipes to see them here!</p>
            </div>
          `;
          return;
        }

        historyList.innerHTML = filtered
          .map(
            (r) => `
          <div class="recipe-item" onclick="loadRecipe('${r.id}')">
            <div class="recipe-item-header">
              <div class="recipe-name">${r.recipeName}</div>
              <button class="favorite-btn" onclick="event.stopPropagation(); toggleRecipeFavorite('${r.id}')">
                ${r.favorite ? "‚≠ê" : "‚òÜ"}
              </button>
            </div>
            <div class="recipe-timestamp">${new Date(r.timestamp).toLocaleString()}</div>
            <div class="recipe-ingredients-preview">${r.ingredients.substring(0, 60)}${r.ingredients.length > 60 ? "..." : ""}</div>
          </div>
        `,
          )
          .join("");
      }

      function filterHistory() {
        const searchQuery = document.getElementById("historySearch").value;
        renderHistory(searchQuery);
      }

      function showFavorites() {
        historyFilter = "favorites";
        document.getElementById("historySearch").value = "";
        renderHistory();
      }

      function showAllHistory() {
        historyFilter = "all";
        document.getElementById("historySearch").value = "";
        renderHistory();
      }

      function loadRecipe(id) {
        const recipes = RecipeManager.getRecipes();
        const recipe = recipes.find((r) => r.id === id);
        if (recipe) {
          RecipeManager.currentRecipeId = id;
          document.getElementById("ingredients").value = recipe.ingredients;
          displayRecipe(recipe.recipe);
          updateFavoriteButton();
          toggleHistory();
          // Scroll to recipe
          document
            .getElementById("recipeOutput")
            .scrollIntoView({ behavior: "smooth" });
        }
      }

      function toggleRecipeFavorite(id) {
        const isFavorite = RecipeManager.toggleFavorite(id);
        renderHistory(document.getElementById("historySearch").value);
        if (id === RecipeManager.currentRecipeId) {
          updateFavoriteButton();
        }
      }

      function toggleFavorite() {
        if (RecipeManager.currentRecipeId) {
          const isFavorite = RecipeManager.toggleFavorite(
            RecipeManager.currentRecipeId,
          );
          updateFavoriteButton();
        }
      }

      function updateFavoriteButton() {
        const btn = document.getElementById("favoriteBtn");
        if (!RecipeManager.currentRecipeId) {
          btn.classList.remove("favorited");
          btn.innerHTML = "‚òÜ Favorite";
          return;
        }

        const recipes = RecipeManager.getRecipes();
        const recipe = recipes.find(
          (r) => r.id === RecipeManager.currentRecipeId,
        );
        if (recipe?.favorite) {
          btn.classList.add("favorited");
          btn.innerHTML = "‚≠ê Favorited";
        } else {
          btn.classList.remove("favorited");
          btn.innerHTML = "‚òÜ Favorite";
        }
      }

      function exportRecipes() {
        const recipes = RecipeManager.getRecipes();
        if (recipes.length === 0) {
          alert("No recipes to export!");
          return;
        }

        if (
          confirm(
            "Export as JSON (for backup) or Text (for reading)?\n\nOK = JSON, Cancel = Text",
          )
        ) {
          RecipeManager.exportToJSON();
        } else {
          RecipeManager.exportToText();
        }
      }

      function clearHistory() {
        RecipeManager.clearAll();
      }

      async function generateRecipe() {
        const ingredients = document.getElementById("ingredients").value.trim();
        const loadingIndicator = document.getElementById("loadingIndicator");
        const recipeOutput = document.getElementById("recipeOutput");
        const errorMessage = document.getElementById("errorMessage");
        const generateBtn = document.getElementById("generateBtn");

        errorMessage.classList.add("hidden");
        recipeOutput.classList.add("hidden");

        if (!ingredients) {
          showError("Please enter some ingredients!");
          return;
        }

        loadingIndicator.classList.remove("hidden");
        generateBtn.disabled = true;

        try {
          const response = await fetch("/api/generate-recipe", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ ingredients: ingredients }),
          });

          const data = await response.json();

          if (data.success) {
            // Save to history
            RecipeManager.saveRecipe(ingredients, data.recipe);
            displayRecipe(data.recipe);
            updateFavoriteButton();
          } else {
            showError(data.error || "Failed to generate recipe");
          }
        } catch (error) {
          showError("Network error: " + error.message);
        } finally {
          loadingIndicator.classList.add("hidden");
          generateBtn.disabled = false;
        }
      }

      function displayRecipe(recipe) {
        const recipeContent = document.getElementById("recipeContent");
        const recipeOutput = document.getElementById("recipeOutput");

        const formattedRecipe = recipe
          .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")
          .replace(/\n\n/g, "</p><p>")
          .replace(/\n/g, "<br>");

        recipeContent.innerHTML = "<p>" + formattedRecipe + "</p>";
        recipeOutput.classList.remove("hidden");
      }

      function showError(message) {
        const errorMessage = document.getElementById("errorMessage");
        errorMessage.textContent = message;
        errorMessage.classList.remove("hidden");
      }

      function clearRecipe() {
        document.getElementById("recipeOutput").classList.add("hidden");
        document.getElementById("ingredients").value = "";
        document.getElementById("ingredients").focus();
        RecipeManager.currentRecipeId = null;
        updateFavoriteButton();
      }

      function copyRecipe(event) {
        const recipeContent = document.getElementById("recipeContent");
        const textContent = recipeContent.innerText;
        const btn = event.target;
        const originalText = btn.textContent;

        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard
            .writeText(textContent)
            .then(() => {
              btn.textContent = "Copied! ‚úì";
              setTimeout(() => {
                btn.textContent = originalText;
              }, 2000);
            })
            .catch((err) => {
              console.error("Clipboard error:", err);
              fallbackCopy(textContent, btn, originalText);
            });
        } else {
          fallbackCopy(textContent, btn, originalText);
        }
      }

      function fallbackCopy(text, btn, originalText) {
        const textarea = document.createElement("textarea");
        textarea.value = text;
        textarea.style.position = "fixed";
        textarea.style.top = "0";
        textarea.style.left = "0";
        textarea.style.opacity = "0";
        textarea.setAttribute("readonly", "");
        document.body.appendChild(textarea);
        textarea.focus();
        textarea.select();

        let success = false;
        try {
          success = document.execCommand("copy");
        } catch (error) {
          console.error("Fallback copy error:", error);
        }

        document.body.removeChild(textarea);

        if (success) {
          btn.textContent = "Copied! ‚úì";
          setTimeout(() => {
            btn.textContent = originalText;
          }, 2000);
        } else {
          showError("Failed to copy recipe to clipboard");
        }
      }

      document
        .getElementById("ingredients")
        .addEventListener("keydown", function (e) {
          if (e.key === "Enter" && !e.shiftKey) {
            e.preventDefault();
            generateRecipe();
          }
        });
    </script>
  </body>
</html>
